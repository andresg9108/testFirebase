rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents { // Se aplica a todas las base de datos
    // Todos pueden acceder
    match /{document=**} {
      allow read, write: if true;
    }

    // Se aplica a la collection posts
    match /posts/{post} { // Cuando se inserta un post
      // Si el usuario est√° autenticado
      allow write, update, delete: if request.auth.uid != null;
      allow list: if true; // Permitir listar todos los posts
    }

    // Se aplica a la collection posts con id uid
    match /posts/{post}/{uid} {
      // Permitir actualizar y eliminar solo si el uid y el email son iguales
      allow update, delete: if request.auth.uid == uid
        && request.resource.data.email == resource.data.email;
    }
  }
}